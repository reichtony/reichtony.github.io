<?php

return <<<'VALUE'
"namespace IPS\\Theme;\nclass class_core_admin_memberprofile extends \\IPS\\Theme\\Template\n{\n\tpublic $cache_key = '365f3b06537aa514c04f6131a3ae9b26';\n\tfunction basicInformation( $member, $canChangePassword, $hasPassword, $activeIntegrations, $actions, $activeSubscription ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$coverPhoto = $member->coverPhoto();\n$return .= <<<CONTENT\n\n<div class='acpMemberView_info ipsBox ipsSpacer_bottom ipsSpacer_double' data-controller='core.global.core.coverPhoto' data-url=\"\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-coverOffset='\nCONTENT;\n$return .= htmlspecialchars( $coverPhoto->offset, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t<div class='acpMemberView_coverPhoto'>\n\t\t\nCONTENT;\n\nif ( $coverPhoto->file ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsCoverPhoto_container'>\n\t\t\t\t<img src='\nCONTENT;\n$return .= htmlspecialchars( $coverPhoto->file->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsCoverPhoto_photo' data-action=\"toggleCoverPhoto\" alt=''>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $coverPhoto->editable and \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_photo' ) and ( !$member->isAdmin() or \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_photo_admin' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<a href='#editCover_menu' id=\"editCover\" data-ipsMenu data-ipsMenu-activeClass='acpMemberView_editButton_active' class='acpMemberView_editButton' data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_cover_photo', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-hideOnCoverEdit data-role='coverPhotoOptions'><i class='fa fa-pencil'><\/i><i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t<div id='editCover_menu' class='ipsMenu ipsHide'>\n\t\t\t\t<ul>\n\t\t\t\t\t<li class=\"ipsMenu_item\">\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( 'do', 'coverPhotoUpload' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_add', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_add', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nif ( $coverPhoto->file ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class='ipsMenu_item ipsHide' data-role=\"photoEditOption\">\n\t\t\t\t\t\t\t<a href='#' data-action='positionCoverPhoto'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_reposition', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li class='ipsMenu_item' data-role=\"photoEditOption\">\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( 'do', 'coverPhotoRemove' )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='removeCoverPhoto'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cover_photo_remove', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<div class='acpMemberView_photo' data-hideOnCoverEdit>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( $member, 'large' );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_photo' ) and ( !$member->isAdmin() or \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_photo_admin' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<a href='#editPhoto_menu' class='acpMemberView_editButton' data-ipsMenu data-ipsMenu-activeClass='acpMemberView_editButton_active' id=\"editPhoto\" title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_profile_photo', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip><i class='fa fa-pencil'><\/i><i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t<div id='editPhoto_menu' class='ipsMenu ipsHide'>\n\t\t\t\t<ul>\n\t\t\t\t\t<li class=\"ipsMenu_item\">\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( 'do', 'photo' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_photo_new', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_photo_new', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nif ( $member->pp_photo_type == 'custom' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\">\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( 'do', 'photoCrop' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_photo_crop', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_photo_crop', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<li class=\"ipsMenu_item\">\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( 'do', 'photoResize' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_photo_resize', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_photo_resize', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $member->pp_photo_type and !in_array( $member->pp_photo_type, array( 'none', 'letter' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsMenu_item\">\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( array( 'do' => 'photo', 'remove' => 1 ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-confirm>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_photo_delete', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<div class='ipsPad'>\n\t\t<p class='ipsType_pageTitle acpMemberView_username' data-controller='core.admin.core.editable' \nCONTENT;\n\nif ( ! $member->name ):\n$return .= <<<CONTENT\ndata-default='empty'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\ndata-url='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString('do', 'name'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) or !$member->isAdmin() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='ipsContained ipsType_break pos' data-name='name'>\n\t\t\t\t\t<span data-role='text'>\nCONTENT;\n\nif ( $member->name ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $member->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'members_name_missing_add', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t<\/span>\n\t\t\t\t<span>\n\t\t\t\t\t<a href='#' data-role='edit' class='acpMemberView_editButton' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_username', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip><i class='fa fa-pencil'><\/i><\/a>\n\t\t\t\t<\/span>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n \t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $member->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n \t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/p>\n\t\t<p class='ipsType_reset ipsType_medium acpMemberView_email' data-controller='core.admin.core.editable' data-url='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString('do', 'email'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) or !$member->isAdmin() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<span class='ipsContained ipsType_break pos' data-name='email'>\n\t\t\t\t\t<span data-role='text'>\nCONTENT;\n$return .= htmlspecialchars( $member->email, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span> \n\t\t\t\t<\/span>\n\t\t\t\t<span>\n\t\t\t\t\t<a href='#' data-role='edit' class='acpMemberView_editButton' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_email_address', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip><i class='fa fa-pencil'><\/i><\/a>\n\t\t\t\t<\/span>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n \t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $member->email, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n \t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/p>\n\t\t<p class='ipsType_reset ipsType_light ipsType_normal'>\nCONTENT;\n\n$htmlsprintf = array($member->joined->html()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_joined', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'htmlsprintf' => $htmlsprintf ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\n\t\t\nCONTENT;\n\nif ( $activeSubscription and $activeSubscription->package ):\n$return .= <<<CONTENT\n\n\t\t\t<p class=\"ipsType_reset ipsType_center ipsType_positive ipsType_normal ipsSpacer_half\">\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'nexus', 'customers', 'purchases_view' ) and $activeSubscription->purchase and $activeSubscription->package ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $activeSubscription->purchase->acpUrl(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsType_blendLinks\">\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<i class=\"fa fa-certificate\"><\/i> &nbsp; \nCONTENT;\n\n$sprintf = array($activeSubscription->package->_title); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'nexus_subs_subscriber', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'nexus', 'customers', 'purchases_view' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/p>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\t\t<hr class='ipsHr'>\n\t\t<ul class='ipsList_reset'>\n\t\t\t\nCONTENT;\n\nif ( count( $actions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsSpacer_bottom ipsSpacer_half'><a href='#memberActions_menu' data-ipsMenu id=\"memberActions\" class='ipsButton ipsButton_primary ipsButton_large ipsButton_fullWidth'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'account_actions', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-caret-down'><\/i><\/a><\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsSpacer_bottom ipsSpacer_half'><a href='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( 'do', 'edit' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_light ipsButton_small ipsButton_fullWidth' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_member_account', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_member_account', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $canChangePassword ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsSpacer_bottom ipsSpacer_half'>\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( 'do', 'password' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_password', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_light ipsButton_small ipsButton_fullWidth'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $hasPassword ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_password', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'set_password', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\t\nCONTENT;\n\nif ( count( $actions ) ):\n$return .= <<<CONTENT\n\n\t\t<div id='memberActions_menu' class='ipsMenu ipsMenu_normal ipsHide'>\n\t\t\t<ul>\n\t\t\t\t\nCONTENT;\n\nforeach ( $actions as $item ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_item \nCONTENT;\n\nif ( isset( $item['class'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $item['class'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $item['link'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( isset( $item['target'] ) ):\n$return .= <<<CONTENT\ntarget='\nCONTENT;\n$return .= htmlspecialchars( $item['target'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( isset( $item['data'] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\nforeach ( $item['data'] as $k => $v ):\n$return .= <<<CONTENT\n data-\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $item['icon'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $item['icon'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i> &nbsp;&nbsp;\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span data-role=\"title\">\nCONTENT;\n\n$val = \"{$item['title']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( count( $activeIntegrations ) ):\n$return .= <<<CONTENT\n\n\t\t\t<div data-controller=\"core.admin.members.lazyLoadingProfileBlock\" data-url=\"\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( array( 'do' => 'lazyBlock', 'block' => 'IPS\\core\\extensions\\core\\MemberACPProfileBlocks\\LoginMethods' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t<div class=\"ipsLoading ipsFaded\">\n\t\t\t\t\t<hr class='ipsHr'>\n\t\t\t\t\t<h3 class='ipsType_minorHeading'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'active_account_integrations', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\n\t\t\t\t\t<ul class='ipsDataList ipsDataList_reducedSpacing acpMemberView_integrations'>\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $activeIntegrations as $title ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class='ipsDataItem'>\n\t\t\t\t\t\t\t\t<div class='ipsDataItem_generic ipsDataItem_size1'>\n\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"default_photo.png\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" class=\"ipsUserPhoto ipsUserPhoto_tiny\">\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t<div class='ipsDataItem_main'>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) or !$member->isAdmin() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t<ul class=\"ipsControlStrip ipsType_noBreak ipsList_reset\">\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"ipsControlStrip_button\">\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\" data-ipsTooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'profilesync_configure', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><i class=\"ipsControlStrip_icon fa fa-pencil\"><\/i><\/a>\n\t\t\t\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\t\t\t\t<li class=\"ipsControlStrip_button\">\n\t\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\" data-ipsTooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_out', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><i class=\"ipsControlStrip_icon fa fa-times-circle\"><\/i><\/a>\n\t\t\t\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<p class='ipsType_normal ipsType_reset acpMemberView_integrations_text'>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<br>\n\t\t\t\t\t\t\t\t\t\t<span class='ipsType_medium ipsType_light'>&nbsp;<\/span>\n\t\t\t\t\t\t\t\t\t<\/p>\n\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction clubs( $member, $clubs ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class=\"ipsPad\">\n\t<ul class='ipsDataList'>\n\t\t\nCONTENT;\n\nforeach ( $clubs as $club ):\n$return .= <<<CONTENT\n\n\t\t\t<li class=\"ipsDataItem \nCONTENT;\n\nif ( \\IPS\\Settings::i()->clubs_require_approval and !$club->approved ):\n$return .= <<<CONTENT\nipsModerated\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t<div class='ipsDataItem_icon'>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"clubs\", \"core\", 'front' )->clubIcon( $club, 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\t<div class='ipsDataItem_main'>\n\t\t\t\t\t<h4 class='ipsDataItem_title ipsContained_container'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->clubs_require_approval and !$club->approved ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_warning\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'club_unapproved', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-eye-slash'><\/i><\/span><\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $club->featured ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<span><span class=\"ipsBadge ipsBadge_small ipsBadge_icon ipsBadge_positive\" data-ipsTooltip title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'featured', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-star'><\/i><\/span><\/span>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class='ipsType_break ipsContained'>\n\t\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $club->url(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' title=\"\nCONTENT;\n$return .= htmlspecialchars( $club->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $club->name, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/h4>\n\t\t\t\t\t<div class='ipsDataItem_meta ipsType_reset ipsType_blendLinks ipsType_break ipsContained' data-ipsTruncate data-ipsTruncate-type='remove' data-ipsTruncate-size='1 lines'>\n\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $club->about, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\t<ul class='ipsDataItem_stats'>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t\nCONTENT;\n\n$val = \"club_{$club->type}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nif ( $club->type !== $club::TYPE_PUBLIC ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li class=\"ipsType_light\">\n\t\t\t\t\t\t\t\nCONTENT;\n\n$pluralize = array( $club->members ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'club_members_count', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'clubs', 'clubs_edit' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class='ipsDataItem_generic ipsDataItem_size3 ipsSpacer_top ipsSpacer_half'>\n\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=clubs&controller=clubs&do=edit&id={$club->id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_light ipsButton_small ipsButton_fullWidth'><i class='fa fa-pencil'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit_club', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction contentBreakdown( $member, $percentages, $rawCounts ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class=\"ipsPad\">\n\t<div class='acpMemberView_statsBar ipsSpacer_bottom'>\n\t\t\nCONTENT;\n\nforeach ( $percentages as $app => $percent ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='acpMemberView_statsBar_segment' style='width: \nCONTENT;\n$return .= htmlspecialchars( $percent, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n%;' title='\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"memberprofile\", \\IPS\\Request::i()->app )->contentStatisticsTooltip( $app, $rawCounts[ $app ], TRUE );\n$return .= <<<CONTENT\n' data-ipsTooltip-label='\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"memberprofile\", \\IPS\\Request::i()->app )->contentStatisticsTooltip( $app, $rawCounts[ $app ] );\n$return .= <<<CONTENT\n' data-ipsTooltip data-ipsTooltip-safe><\/div>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<ul class='ipsList_inline'>\n\t\t\nCONTENT;\n\nforeach ( $percentages as $app => $percent ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='acpMemberView_statsBar_legend'>\n\t\t\t\t<span class='acpMemberView_statsBar_preview'><\/span>\n\t\t\t\t\nCONTENT;\n\nif ( $app == 'core' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'module__core_status', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$val = \"__app_{$app}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction contentStatisticsTooltip( $app, $counts, $noHtml=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $noHtml ):\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $counts as $class => $count ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$val = \"{$class::$title}_pl\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n: \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $count );\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<strong>\n\t\t\nCONTENT;\n\nif ( $app == 'core' ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'module__core_status', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$val = \"__app_{$app}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/strong>\n\t<table>\n\t\t\nCONTENT;\n\nforeach ( $counts as $class => $count ):\n$return .= <<<CONTENT\n\n\t\t\t<tr>\n\t\t\t\t<td>\nCONTENT;\n\n$val = \"{$class::$title}_pl\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/td>\n\t\t\t\t<td class=\"ipsType_right\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $count );\n$return .= <<<CONTENT\n<\/td>\n\t\t\t<\/tr>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/table>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction devicesAndIPAddresses( $member, $lastUsedIp, $devices ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='acpMemberView_devices ipsBox ipsSpacer_bottom ipsSpacer_double'>\n\t<h2 class='ipsBox_titleBar ipsType_reset'>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->ipsgeoip and \\IPS\\GeoLocation::enabled() ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'devices_and_locations', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'devices_and_ips', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/h2>\n\t<div class='ipsTabs ipsTabs_contained ipsTabs_small ipsTabs_stretch ipsClearfix' id='tabs_devices' data-ipsTabBar data-ipsTabBar-contentArea='#ipsTabs_content_devices'>\n\t\t<a href='#tabs_devices' data-action='expandTabs'><i class='fa fa-caret-down'><\/i><\/a>\n\t\t<ul role='tablist'>\n\t\t\t<li>\n\t\t\t\t<a href='#ipsTabs_tabs_devices_devices_tab_location_panel' id='devices_tab_location' class=\"ipsTabs_item\" role=\"tab\">\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->ipsgeoip and \\IPS\\GeoLocation::enabled() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_ip_locations', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ip_addresses', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t\t<li>\n\t\t\t\t<a href='#ipsTabs_tabs_devices_devices_tab_devices_panel' id='devices_tab_devices' class=\"ipsTabs_item\" role=\"tab\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'members_devices', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/a>\n\t\t\t<\/li>\n\t\t<\/ul>\n\t<\/div>\n\t<div id='ipsTabs_content_devices'>\n\t\t<div id='ipsTabs_tabs_devices_devices_tab_location_panel' class=\"ipsTabs_panel ipsPad\" aria-labelledby=\"devices_tab_location\" aria-hidden=\"false\">\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->ipsgeoip and \\IPS\\GeoLocation::enabled() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div data-controller=\"core.admin.members.lazyLoadingProfileBlock\" data-url=\"\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( array( 'do' => 'lazyBlock', 'block' => 'IPS\\core\\extensions\\core\\MemberACPProfileBlocks\\Locations' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<div class='acpMemberView_map ipsLoading ipsLoading_tiny'><\/div>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsGrid ipsSpacer_top ipsSpacer_half'>\n\t\t\t\t<div class='ipsGrid_span12'>\n\t\t\t\t\t<h3 class='ipsType_minorHeading'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'registration_ip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t<p class='ipsType_medium ipsType_reset'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'membertools_ip' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=ip&ip={$member->ip_address}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_blendLinks\">\nCONTENT;\n$return .= htmlspecialchars( $member->ip_address, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $member->ip_address, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/p>\n\t\t\t\t<\/div>\n\t\t\t\t<div class='ipsGrid_span12 ipsSpacer_top ipsSpacer_half'>\n\t\t\t\t\t<h3 class='ipsType_minorHeading'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'last_used_ip', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t<p class='ipsType_medium ipsType_reset'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'membertools_ip' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=ip&ip={$lastUsedIp}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_blendLinks\">\nCONTENT;\n$return .= htmlspecialchars( $lastUsedIp, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $lastUsedIp, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/p>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'membertools_ip' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=ip&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_verySmall ipsButton_light ipsSpacer_top ipsSpacer_half ipsButton_fullWidth\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_all_ip_addresses', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t<div id='ipsTabs_tabs_devices_devices_tab_devices_panel' class=\"ipsTabs_panel ipsPad\" aria-labelledby=\"devices_tab_devices\" aria-hidden=\"false\">\n\t\t\t<ul class='ipsDataList ipsDataList_reducedSpacing'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $devices as $device ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsDataItem'>\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=devices&do=device&key={$device->device_key}&member={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_blendLinks\">\n\t\t\t\t\t\t\t<div class='ipsDataItem_generic ipsDataItem_size1'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $device->userAgent()->platform === 'Macintosh' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"logos\/devices\/mac.png\", \"\", 'interface', false );\n$return .= <<<CONTENT\n\" class=\"ipsImage\">\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $device->userAgent()->platform === 'Android' or $device->userAgent()->platform === 'Windows Phone' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"logos\/devices\/android.png\", \"\", 'interface', false );\n$return .= <<<CONTENT\n\" class=\"ipsImage\">\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $device->userAgent()->platform === 'iPad' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"logos\/devices\/ipad.png\", \"\", 'interface', false );\n$return .= <<<CONTENT\n\" class=\"ipsImage\">\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $device->userAgent()->platform === 'iPhone' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"logos\/devices\/iphone.png\", \"\", 'interface', false );\n$return .= <<<CONTENT\n\" class=\"ipsImage\">\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"logos\/devices\/pc.png\", \"\", 'interface', false );\n$return .= <<<CONTENT\n\" class=\"ipsImage\">\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t<div class='ipsDataItem_main'>\n\t\t\t\t\t\t\t\t<p class='ipsType_normal ipsType_reset'>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $device->userAgent()->platform, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<br>\n\t\t\t\t\t\t\t\t\t<span class='ipsType_medium ipsType_light'>\nCONTENT;\n\n$sprintf = array(\\IPS\\DateTime::ts( $device->last_seen )->relative()); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'device_last_loggedin', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t\t<\/p>\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'membertools_ip' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=devices&do=member&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_verySmall ipsButton_light ipsSpacer_top ipsSpacer_half ipsButton_fullWidth\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_all_devices', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction downloadPersonalInfo( $member ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class=\"ipsPad\">\n\t<div class=\"ipsType_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_export_pi_explain', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/div>\n\t<div class=\"ipsPad ipsType_center\">\n\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=exportPersonalInfo&id={$member->member_id}&process=1\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_primary\"><i class=\"fa fa-download\"><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'download', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction groups( $member, $secondaryGroups ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='acpMemberView_groups ipsBox ipsSpacer_bottom ipsSpacer_double'>\n\t<h2 class='ipsBox_titleBar ipsType_reset'>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( !$member->isAdmin() or ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) and  \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_move_admin1' ) ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=editBlock&block=IPS\\\\core\\\\extensions\\\\core\\\\MemberACPProfileBlocks\\\\Groups&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsPos_right ipsType_medium\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'groups', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'groups', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t<\/h2>\n\t<div class='ipsPad ipsClearfix'>\n\t\t\nCONTENT;\n\nif ( $member->group['g_icon']  ):\n$return .= <<<CONTENT\n\n\t\t\t<img src='\nCONTENT;\n\n$return .= \\IPS\\File::get( \"core_Theme\", $member->group['g_icon'] )->url;\n$return .= <<<CONTENT\n' alt='' class=\"ipsPos_right\">\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<h3 class='ipsType_minorHeading'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'primary_group', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&advanced_search_submitted=1&members_member_group_id={$member->group['g_id']}&noColumn=1\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_normal ipsType_blendLinks\">\n\t\t\t{$member->groupName}\n\t\t<\/a>\n\t\t\nCONTENT;\n\nif ( $secondaryGroups ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsSpacer_top ipsSpacer_half\">\n\t\t\t\t<h3 class='ipsType_minorHeading'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'secondary_groups', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t<ul class=\"ipsList_reset\">\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $secondaryGroups as $group ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&advanced_search_submitted=1&members_member_group_id={$group->g_id}&noColumn=1\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_medium ipsType_blendLinks\">{$group->formattedName}<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction header( $member, $validatingRow, $sparkline ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nif ( $validatingRow ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsMessage ipsMessage_general acpMemberView_message ipsSpacer_bottom ipsSpacer_double\">\n\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'membertools_validating' ) ):\n$return .= <<<CONTENT\n\n\t\t\t<ul class='ipsButton_split ipsPos_right'>\n\t\t\t\t<li><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( 'do', 'approve' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton \nCONTENT;\n\nif ( !$validatingRow['user_verified'] ):\n$return .= <<<CONTENT\nipsButton_small\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsButton_medium\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsButton_positive\" data-confirm>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'approve', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nif ( !$validatingRow['user_verified'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( 'do', 'resendEmail' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_small ipsButton_light\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'resend_validation_email', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<li><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( array( 'do' => 'ban', 'permban' => 1 ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton \nCONTENT;\n\nif ( !$validatingRow['user_verified'] ):\n$return .= <<<CONTENT\nipsButton_small\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsButton_medium\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsButton_negative\" data-confirm>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ban', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t<\/ul>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<h4 class='ipsMessage_title'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reg_admin_validation', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t<p class='ipsType_reset ipsType_normal'>\nCONTENT;\n$return .= htmlspecialchars( $member->validatingDescription(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/p>\t\t\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $time = $member->isBanned() ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsMessage ipsMessage_error acpMemberView_message ipsSpacer_bottom ipsSpacer_double\">\n\t\t\nCONTENT;\n\nif ( $member->temp_ban and \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_ban' ) and ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_ban_admin' ) or !$member->isAdmin() ) AND $member->member_id != \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( array( 'do' => 'ban' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'adjust_ban', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_medium ipsButton_veryLight ipsPos_right\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'adjust_ban', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<h4 class='ipsMessage_title'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'banned', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\nCONTENT;\n\nif ( $time === TRUE ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $member->temp_ban ):\n$return .= <<<CONTENT\n\n\t\t\t\t<p class='ipsType_reset ipsType_normal'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'account_banned_perm', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<p class='ipsType_reset ipsType_normal'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'account_banned_group', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<p class='ipsType_reset ipsType_normal'>\nCONTENT;\n\n$sprintf = array($time); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'account_banned_time', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nelseif ( $member->members_bitoptions['bw_is_spammer'] ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsMessage ipsMessage_error acpMemberView_message ipsSpacer_bottom ipsSpacer_double\">\n\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and (\\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) or !$member->isAdmin() ) ):\n$return .= <<<CONTENT\n\n\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( array( 'do' => 'spam', 'status' => 0 ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_medium ipsButton_veryLight ipsPos_right\" data-confirm data-confirmSubmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'spam_unflag_confirm', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'spam_unflag', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<h4 class='ipsMessage_title'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'account_flagged_as_spammer_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t<p class='ipsType_reset ipsType_normal'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'account_flagged_as_spammer', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\t\t\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( \\IPS\\Settings::i()->ipb_bruteforce_attempts and $member->failed_login_count >= \\IPS\\Settings::i()->ipb_bruteforce_attempts ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsMessage ipsMessage_warning acpMemberView_message ipsSpacer_bottom ipsSpacer_double\">\n\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( array( 'do' => 'unlock' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_veryLight ipsButton_medium ipsPos_right\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unlock', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\n\t\t<h4 class='ipsMessage_title'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'account_locked_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t<p class='ipsType_reset ipsType_normal'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'account_locked_logins', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\t\t\n\t<\/div>\n\nCONTENT;\n\nelseif ( \\IPS\\Settings::i()->security_questions_tries and $member->failed_mfa_attempts >= \\IPS\\Settings::i()->security_questions_tries ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsMessage ipsMessage_warning acpMemberView_message ipsSpacer_bottom ipsSpacer_double\">\n\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( array( 'do' => 'unlock' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_veryLight ipsButton_medium ipsPos_right\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'unlock', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\n\t\t<h4 class='ipsMessage_title'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'account_locked_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t<p class='ipsType_reset ipsType_normal'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'account_locked_2fa', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( ! $member->name or ! $member->email ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsMessage ipsMessage_error acpMemberView_message ipsSpacer_bottom ipsSpacer_double\">\n\t\t\nCONTENT;\n\nif ( $member->members_bitoptions['created_externally'] ):\n$return .= <<<CONTENT\n\n\t\t\t<h4 class='ipsMessage_title'>\n\t\t\t\t\nCONTENT;\n\nif ( ! $member->name and ! $member->email ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_reserved_external_both', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( ! $member->name ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_reserved_external_name', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( ! $member->email ):\n$return .= <<<CONTENT\n\t\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_reserved_external_email', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/h4>\n\t\t\t<p class='ipsType_reset ipsType_normal'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'members_name_missing_as_reserved_external', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\nCONTENT;\n\nelseif ( ( $member->last_visit == 0 and $member->joined->getTimestamp() > ( time() - 3600 ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$mins = ceil( ( $member->joined->getTimestamp() - ( time() - 3600 ) ) \/ 60 );\n$return .= <<<CONTENT\n\n\t\t\t<h4 class='ipsMessage_title'>\nCONTENT;\n\n$sprintf = array($mins); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_reserved_pending_deletion', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/h4>\n\t\t\t<p class='ipsType_reset ipsType_normal'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'members_name_missing_as_reserved_tt', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<div class='acpMemberView_stats ipsSpacer_bottom ipsSpacer_double'>\n\t<div class='ipsGrid ipsGrid_collapseTablet'>\n\t\t<div class='ipsGrid_span\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n6\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n9\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsSpacer_bottom'>\n\t\t\t{$sparkline}\n\t\t<\/div>\n\t\t<div class='ipsGrid_span3 ipsSpacer_bottom'>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) or !$member->isAdmin() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href='#memberPostsBlock_menu' id='memberPostsBlock' data-ipsMenu class='acpMemberView_countStat acpMemberView_contentCount' title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_ranks_posts_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip>\n\t\t\t\t\t<h3 class='ipsType_minorHeading ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'members_member_posts', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t<p class='ipsType_large ipsType_reset acpMemberView_countStatStat ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $member->member_posts );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t<\/a>\n\t\t\t\t<div id='memberPostsBlock_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=editBlock&block=IPS\\\\core\\\\extensions\\\\core\\\\MemberACPProfileBlocks\\\\Header&id={$member->member_id}&type=content\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'members_member_posts', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'set_manually', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=recountContent&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-confirm data-confirmType=\"verify\" data-confirmButtons='\nCONTENT;\n\n$return .= json_encode( array( 'yes' => \\IPS\\Member::loggedIn()->language()->addToStack('yes'), 'no' => \\IPS\\Member::loggedIn()->language()->addToStack('recount_all'), 'cancel' => \\IPS\\Member::loggedIn()->language()->addToStack('cancel') ) );\n$return .= <<<CONTENT\n' data-confirmSubMessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_content_items_recount', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recount', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'membertools_delete' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=deleteContent&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_delete_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_delete_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<span id='memberPostsBlock' data-ipsMenu class='acpMemberView_countStat acpMemberView_contentCount' title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_ranks_posts_desc', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-ipsTooltip>\n\t\t\t\t\t<h3 class='ipsType_minorHeading'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'members_member_posts', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t<p class='ipsType_large ipsType_reset acpMemberView_countStatStat'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $member->member_posts );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t<\/span>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->reputation_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsGrid_span3 ipsSpacer_bottom'>\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) or !$member->isAdmin() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='#memberRepBlock_menu' id=\"memberRepBlock\" data-ipsMenu class='acpMemberView_countStat acpMemberView_repCount'>\n\t\t\t\t\t\t<h3 class='ipsType_minorHeading ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_reputation', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t\t<p class='ipsType_large ipsType_reset acpMemberView_countStatStat ipsTruncate ipsTruncate_line'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $member->pp_reputation_points );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t<\/a>\n\t\t\t\t\t<div id='memberRepBlock_menu' class='ipsMenu ipsMenu_narrow ipsHide'>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=editBlock&block=IPS\\\\core\\\\extensions\\\\core\\\\MemberACPProfileBlocks\\\\Header&id={$member->member_id}&type=reputation\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'members_member_posts', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'set_manually', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=recountReputation&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-confirm data-confirmType=\"verify\" data-confirmButtons='\nCONTENT;\n\n$return .= json_encode( array( 'yes' => \\IPS\\Member::loggedIn()->language()->addToStack('yes'), 'no' => \\IPS\\Member::loggedIn()->language()->addToStack('recount_all'), 'cancel' => \\IPS\\Member::loggedIn()->language()->addToStack('cancel') ) );\n$return .= <<<CONTENT\n' data-confirmSubMessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_reputation_recount', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'recount', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=removeReputation&type=given&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-confirm>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reputation_remove_given', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\t<li class=\"ipsMenu_item\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=removeReputation&type=received&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-confirm>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'reputation_remove_received', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<span id=\"memberRepBlock\" data-ipsMenu class='acpMemberView_countStat acpMemberView_repCount'>\n\t\t\t\t\t\t<h3 class='ipsType_minorHeading'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_reputation', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t\t\t\t\t<p class='ipsType_large ipsType_reset acpMemberView_countStatStat'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $member->pp_reputation_points );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t<\/span>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction history( $member, $history, $historyFilters ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elMemberHistory' data-controller=\"core.admin.members.history\">\n\t<h2 class='ipsType_sectionTitle ipsType_reset ipsClearfix'>\n\t\t<a href='#memberHistoryFilters_menu' id='memberHistoryFilters' data-ipsMenu>\n\t\t\t<span data-role=\"historyTitle\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'all_recent_account_activity', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t<span class=\"ipsPos_right\"><i class=\"fa fa-caret-down\"><\/i><\/span>\n\t\t<\/a>\n\t<\/h2>\n\t<div id='memberHistoryFilters_menu' class='ipsMenu ipsHide'>\n\t\t<ul>\n\t\t\t\nCONTENT;\n\n$logApp = NULL;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $historyFilters as $filter ):\n$return .= <<<CONTENT\n\t\t\n\t\t\t\t\nCONTENT;\n\nif ( $logApp != $filter['log_app'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsMenu_title\">\nCONTENT;\n\n$val = \"memberlog_app_{$filter['log_app']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/li>\n\t\t\t\t\t\nCONTENT;\n\n$logApp = $filter['log_app'];\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<li class=\"ipsMenu_item\" data-ipsMenuValue=\"\nCONTENT;\n$return .= htmlspecialchars( $filter['log_app'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n$return .= htmlspecialchars( $filter['log_type'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=history&id={$member->member_id}&advanced_search_submitted=1&log_type={$filter['log_type']}&_fromFilter=1\" . \"&csrfKey=\" . \\IPS\\Session::i()->csrfKey, null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$val = \"log_type_title_{$filter['log_type']}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<li class=\"ipsMenu_sep\"><hr><\/li>\n\t\t\t<li class=\"ipsMenu_item\" data-ipsMenuValue=\"\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=history&id={$member->member_id}&_fromFilter=1\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'all_recent_account_activity', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t<\/ul>\n\t<\/div>\n\t<div class=\"ipsPad\" data-role=\"historyDisplay\">\n\t\t{$history}\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction historyRows( $table, $headers, $rows ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\n$currentTimestamp = null;\n$return .= <<<CONTENT\n\n\nCONTENT;\n\nforeach ( $rows as $row ):\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $currentTimestamp != $row['log_date']->format('n') . '|' . $row['log_date']->format('Y') ):\n$return .= <<<CONTENT\n\n\t\t<li class='cMemberHistory_date'>\n\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $row['log_date']->strFormat('%B'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n$return .= htmlspecialchars( $row['log_date']->strFormat('%Y'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t<\/li>\n\t\t\nCONTENT;\n\n$currentTimestamp = $row['log_date']->format('n') . '|' . $row['log_date']->format('Y');\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<li class='ipsClearfix'>\n\t\t<div class='cMemberHistory_info ipsType_normal'>\n\t\t\t{$row['log_data']}\n\t\t\t<br>\n\t\t\t<span class='ipsType_medium ipsType_light ipsType_blendLinks'>\n\t\t\t\t{$row['log_date']->html()}\n\t\t\t\t\nCONTENT;\n\nif ( $row['log_ip_address'] and \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'membertools_ip' ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t&nbsp;&nbsp;{$row['log_ip_address']}\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/span>\n\t\t<\/div>\n\t<\/li>\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction historyTable( $table, $headers, $rows, $quickSearch ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( count( $rows ) ):\n$return .= <<<CONTENT\n\n\t<ol class='ipsClear ipsList_reset cMemberHistory \nCONTENT;\n\nforeach ( $table->classes as $class ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $class, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n' id='elTable_\nCONTENT;\n$return .= htmlspecialchars( $table->uniqueId, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-role=\"tableRows\">\n\t\t\nCONTENT;\n\n$return .= $table->rowsTemplate[0]->{$table->rowsTemplate[1]}( $table, $headers, $rows );\n$return .= <<<CONTENT\n\n\t<\/ol>\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t<div class='ipsType_center ipsFaded'>\n\t\t<p class='ipsSpacer_top ipsSpacer_double'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'customer_no_history', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<div class='ipsClearfix'>\n\t\nCONTENT;\n\nif ( $table->pages > 1 ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsType_center\">\n\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $table->baseUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_verySmall ipsButton_fullWidth ipsButton_normal\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'see_all_history', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction lazyLoad( $member, $block ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-controller=\"core.admin.members.lazyLoadingProfileBlock\" data-url=\"\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( array( 'do' => 'lazyBlock', 'block' => $block ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t<div class=\"ipsSpacer_bottom ipsType_center\">\n\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"tiny_loading.gif\", \"core\", '', false );\n$return .= <<<CONTENT\n\">\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction locations( $member, $mapMarkers ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-ipsMap data-ipsMap-apiKey=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Settings::i()->google_maps_api_key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsMap-markers=\"\nCONTENT;\n\n$return .= htmlspecialchars( json_encode( $mapMarkers ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsMap-zoom=\"0\" class=\"ipsMap ipsMap_small\"><\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction loginMethods( $member, $loginMethods ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( count( $loginMethods ) ):\n$return .= <<<CONTENT\n\n\t<hr class='ipsHr'>\n\t<h3 class='ipsType_minorHeading'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'active_account_integrations', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\n\t<ul class='ipsDataList ipsDataList_reducedSpacing acpMemberView_integrations'>\n\t\t\nCONTENT;\n\nforeach ( $loginMethods as $id => $details ):\n$return .= <<<CONTENT\n\n\t\t\t<li class='ipsDataItem'>\n\t\t\t\t<div class='ipsDataItem_icon'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $details['link'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $details['link'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" target=\"_blank\" class=\"ipsType_blendLinks\">\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( isset( $details['icon'] ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<img src=\"\nCONTENT;\n$return .= htmlspecialchars( $details['icon'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsUserPhoto ipsUserPhoto_tiny\">\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"default_photo.png\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" class=\"ipsUserPhoto ipsUserPhoto_tiny\">\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $details['link'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\t<div class='ipsDataItem_main'>\n\t\t\t\t\t\nCONTENT;\n\nif ( isset( $details['edit'] ) and ( $details['edit'] or $details['delete'] ) and \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) or !$member->isAdmin() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<ul class=\"ipsControlStrip ipsType_noBreak ipsList_reset\">\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $details['edit'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class=\"ipsControlStrip_button\">\n\t\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=loginEdit&id={$member->member_id}&method={$id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n$return .= htmlspecialchars( $details['title'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-ipsTooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'profilesync_configure', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><i class=\"ipsControlStrip_icon fa fa-pencil\"><\/i><\/a>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $details['delete'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li class=\"ipsControlStrip_button\">\n\t\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=loginDelete&id={$member->member_id}&method={$id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-confirm data-ipsTooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_out', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><i class=\"ipsControlStrip_icon fa fa-times-circle\"><\/i><\/a>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class='ipsType_normal ipsType_reset acpMemberView_integrations_text'>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $details['link'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $details['link'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" target=\"_blank\" class=\"ipsType_blendLinks\">\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $details['title'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<br>\n\t\t\t\t\t\t<span class='ipsType_medium ipsType_light'>\nCONTENT;\n$return .= htmlspecialchars( $details['blurb'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $details['link'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/p>\n\t\t\t\t<\/div>\n\n\t\t\t<\/li>\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t<\/ul>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mainTemplate( $member, $extensions, $activeTab, $activeTabContent, $history ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='acpMemberView'>\n\t\n\t\nCONTENT;\n\nif ( count( $extensions ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsTabs acpMemberView_tabBar ipsClearfix ipsJS_show' id='tabs_member' data-ipsTabBar data-ipsTabBar-contentArea='#ipsTabs_content_member' data-ipsTabBar-panelClass=\"acpMemberView_tabBarPanel\">\n\t\t\t<a href='#tabs_member' data-action='expandTabs'><i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t<ul role='tablist'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $extensions as $key => $classname ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( 'tab', $key ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='member_tab_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class=\"ipsTabs_item \nCONTENT;\n\nif ( $key == $activeTab ):\n$return .= <<<CONTENT\nipsTabs_activeItem\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" role=\"tab\">\n\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $classname::title(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\n\t\nCONTENT;\n\nif ( $history ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"acpMemberView_layoutWrap\">\n\t\t\t<div class=\"acpMemberView_layoutMain\">\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\n\t<div id='ipsTabs_content_member'>\n\t\t<div id=\"ipsTabs_tabs_member_member_tab_\nCONTENT;\n$return .= htmlspecialchars( $activeTab, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_panel\" class=\"ipsTabs_panel acpMemberView_tabBarPanel\" aria-labelledby=\"member_tab_\nCONTENT;\n$return .= htmlspecialchars( $activeTab, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" aria-hidden=\"false\">\n\t\t\t{$activeTabContent}\n\t\t<\/div>\n\t<\/div>\n\t\n\t\n\t\nCONTENT;\n\nif ( $history ):\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\t<div class=\"acpMemberView_layoutHistory\">\n\t\t\t\t{$history}\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mfa( $member, $configuredHandlers, $hasSecurityQuestions, $showEditButton ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='acpMemberView_2fa ipsBox ipsSpacer_bottom ipsSpacer_double'>\n\t<h2 class='ipsBox_titleBar ipsType_reset'>\n\t\t\nCONTENT;\n\nif ( $showEditButton and \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( !$member->isAdmin() or \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=editBlock&block=IPS\\\\core\\\\extensions\\\\core\\\\MemberACPProfileBlocks\\\\MFA&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsPos_right ipsType_medium\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member__core_SecurityAnswers', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member__core_SecurityAnswers', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t<\/h2>\n\t<div class='ipsPad'>\n\t\t\nCONTENT;\n\nif ( $member->members_bitoptions['security_questions_opt_out'] and \\IPS\\Settings::i()->mfa_required_groups != '*' and !$member->inGroup( explode( ',', \\IPS\\Settings::i()->mfa_required_groups ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsType_negative ipsType_sectionHead\">\n\t\t\t\t<i class=\"fa fa-times-circle\"><\/i> &nbsp; \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_opted_out', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nforeach ( $configuredHandlers as $key => $handler ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsType_positive ipsSpacer_top ipsSpacer_half ipsType_sectionHead\">\n\t\t\t\t\t<i class=\"fa fa-check-circle\"><\/i> &nbsp; \nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->addToStack( 'mfa_' . $key . '_title' )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_method_enabled', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( !count( $configuredHandlers ) and !$hasSecurityQuestions ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsType_neutral\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_mfa_methods_enabled', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->security_questions_enabled and $hasSecurityQuestions ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( count( $configuredHandlers ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<hr class='ipsHr'>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$answers = $member->securityAnswers();\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( count( $answers ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $answers as $questionId => $answer ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div class=\"ipsSpacer_bottom ipsSpacer_half\">\n\t\t\t\t\t\t\t<h2 class='ipsType_reset ipsType_minorHeading'>\nCONTENT;\n\n$val = \"security_question_{$questionId}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t\t\t\t<p class='ipsType_reset ipsType_medium'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Text\\Encrypt::fromTag( $answer )->decrypt(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/p>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction oauth( $member, $apps ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='acpMemberView_2fa ipsBox ipsSpacer_bottom ipsSpacer_double'>\n\t<h2 class='ipsBox_titleBar ipsType_reset'>\n\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=applications&controller=api&do=tokens&member_id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsPos_right ipsType_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'oauth_view_details', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'oauth_member_authorized_apps', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t<\/h2>\n\t\nCONTENT;\n\nif ( count( $apps ) ):\n$return .= <<<CONTENT\n\n\t\t<ul class=\"ipsDataList\">\n\t\t\t\nCONTENT;\n\nforeach ( $apps as $app ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class='ipsDataItem'>\n\t\t\t\t\t<div class='ipsDataItem_main'>\n\t\t\t\t\t\t<ul class=\"ipsControlStrip ipsType_noBreak ipsList_reset\">\n\t\t\t\t\t\t\t<li class=\"ipsControlStrip_button\">\n\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=applications&controller=oauth&do=revokeToken&client_id={$app['data']['client_id']}&member_id={$app['data']['member_id']}&token={$app['data']['access_token']}&r=p\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-confirm data-ipsTooltip title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'oauth_app_revoke', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"><i class=\"ipsControlStrip_icon fa fa-times-circle\"><\/i><\/a>\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t\t<div class='ipsType_normal ipsType_reset'>\n\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $app['title'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<div class='ipsType_medium ipsType_light'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"api\", \\IPS\\Request::i()->app )->oauthStatus( $app['data'], $app['use_refresh_tokens'] );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsPad ipsType_reset ipsType_light\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_oauth_apps', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction profileData( $member, $fields ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsPad'>\n\t\nCONTENT;\n\nif ( $member->member_title || $member->rank['title'] || $member->rank['image'] || \\IPS\\Settings::i()->profile_birthday_type != 'none' || \\IPS\\Settings::i()->signatures_enabled ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsSpacer_bottom\">\n\t\t\t<h2 class=\"ipsType_reset ipsType_minorHeading\">\nCONTENT;\n\n$sprintf = array($member->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'profile_about', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t<ul class=\"ipsDataList ipsDataList_reducedSpacing\">\n\t\t\t\t\nCONTENT;\n\nif ( $member->member_title || $member->rank['title'] || $member->rank['image'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsDataItem'>\n\t\t\t\t\t\t<span class='ipsDataItem_generic ipsDataItem_size3 ipsType_break'><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'profile_rank', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/span>\n\t\t\t\t\t\t<div class='ipsDataItem_generic ipsType_break'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $member->member_title ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $member->member_title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $member->rank['title'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $member->rank['title'], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t{$member->rank['image']}\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->profile_birthday_type != 'none' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsDataItem'>\n\t\t\t\t\t\t<span class='ipsDataItem_generic ipsDataItem_size3 ipsType_break'><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'bday', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/span>\n\t\t\t\t\t\t<span class='ipsDataItem_generic'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $member->birthday ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $member->birthday, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<em class=\"ipsType_light\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_value', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/em>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->signatures_enabled ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsDataItem'>\n\t\t\t\t\t\t<span class='ipsDataItem_generic ipsDataItem_size3 ipsType_break'><strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'signature', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/span>\n\t\t\t\t\t\t<span class='ipsDataItem_generic ipsType_richText'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $member->signature ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Text\\Parser::mungeResources( $member->signature, TRUE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<em class=\"ipsType_light\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_value', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/em>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nforeach ( $fields as $groupKey => $values ):\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsSpacer_bottom\">\n\t\t\t<h2 class=\"ipsType_reset ipsType_minorHeading\">\nCONTENT;\n\n$val = \"{$groupKey}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t<ul class=\"ipsDataList ipsDataList_reducedSpacing\">\n\t\t\t\t\nCONTENT;\n\nforeach ( $values as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsDataItem ipsType_break'>\n\t\t\t\t\t\t<span class='ipsDataItem_generic ipsDataItem_size3 ipsType_break'><strong>\nCONTENT;\n\n$val = \"{$k}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><\/span>\n\t\t\t\t\t\t<div class='ipsDataItem_generic'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( (string) $v === '' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<em class=\"ipsType_light\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_value', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/em>\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<div class='ipsType_break ipsContained'>{$v}<\/div>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction quotas( $member, $messengerCount, $messengerPercent, $attachmentStorage, $attachmentPercent, $viewAttachmentsLink ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $member->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'messaging', 'front' ) ) or $attachmentStorage !== NULL ):\n$return .= <<<CONTENT\n\n\t<div class='ipsGrid ipsGrid_collapsePhone acpMemberView_quotas'>\n\t\t<div class='ipsGrid_span6'>\n\t\t\t<div class='acpMemberView_quota ipsBox ipsSpacer_bottom ipsSpacer_double'>\n\t\t\t\t<h2 class='ipsBox_titleBar ipsType_reset'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $member->canAccessModule( \\IPS\\Application\\Module::get( 'core', 'messaging', 'front' ) ) and \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( !$member->isAdmin() or \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $messengerCount === NULL ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=editBlock&block=IPS\\\\core\\\\extensions\\\\core\\\\MemberACPProfileBlocks\\\\Quotas&id={$member->member_id}&enable=1\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsPos_right ipsType_medium\" data-confirm>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'admin_enable_messenger', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=editBlock&block=IPS\\\\core\\\\extensions\\\\core\\\\MemberACPProfileBlocks\\\\Quotas&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsPos_right ipsType_medium\" data-confirm data-confirmType=\"verify\" data-confirmIcon=\"question\" data-confirmMessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'admin_disable_messenger', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-confirmSubMessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'admin_disable_messenger_confirm', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-confirmButtons='\nCONTENT;\n\n$return .= json_encode( array( 'yes' => \\IPS\\Member::loggedIn()->language()->addToStack('no'), 'no' => \\IPS\\Member::loggedIn()->language()->addToStack('yes'), 'cancel' => \\IPS\\Member::loggedIn()->language()->addToStack('cancel') ) );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'admin_disable_messenger', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_quota_header', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/h2>\n\t\t\t\t<div class='ipsPad'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $messengerCount !== NULL ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $messengerPercent !== NULL ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<div class=\"ipsAttachment_progress acpMemberView_progress ipsSpacer_bottom ipsSpacer_half\"><span style='width: \nCONTENT;\n\nif ( $messengerPercent > 100 ):\n$return .= <<<CONTENT\n100\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $messengerPercent, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n%'><\/span><\/div>\n\t\t\t\t\t\t\t<span class='acpMemberView_percentage ipsFaded ipsPos_right ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $messengerPercent );\n$return .= <<<CONTENT\n%<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\n\t\t\t\t\t\t<span class='acpMemberView_quotaNumber ipsType_large'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $messengerCount );\n$return .= <<<CONTENT\n<\/span><br>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $member->group['g_max_messages'] > 0 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span class='ipsType_medium ipsType_light'>\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->language()->formatNumber( $member->group['g_max_messages'] )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'quota_allowance', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span class='ipsType_medium ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'quota_allowance_unlimited', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div class=\"ipsType_medium ipsType_light\">\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $member->members_disable_pm == 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_quota_disabled_self', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nelseif ( $member->members_disable_pm == 2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_quota_disabled_admin', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'messenger_quota_disabled_group', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='ipsGrid_span6'>\n\t\t\t<div class='acpMemberView_quota ipsBox ipsSpacer_bottom ipsSpacer_double'>\n\t\t\t\t<h2 class='ipsBox_titleBar ipsType_reset'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $viewAttachmentsLink ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $viewAttachmentsLink, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsPos_right ipsType_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'view_attachments', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'my_attachment_quota', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/h2>\n\t\t\t\t<div class='ipsPad'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $attachmentStorage !== NULL ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $attachmentPercent !== NULL ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<div class=\"ipsAttachment_progress acpMemberView_progress ipsSpacer_bottom ipsSpacer_half\"><span style='width: \nCONTENT;\n\nif ( $attachmentPercent > 100 ):\n$return .= <<<CONTENT\n100\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $attachmentPercent, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n%;'><\/span><\/div>\n\t\t\t\t\t\t\t<span class='acpMemberView_percentage ipsFaded ipsPos_right ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->formatNumber( $attachmentPercent );\n$return .= <<<CONTENT\n%<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<span class='acpMemberView_quotaNumber ipsType_large'>\nCONTENT;\n\n$return .= \\IPS\\Output\\Plugin\\Filesize::humanReadableFilesize( $attachmentStorage );\n$return .= <<<CONTENT\n<\/span><br>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $member->group['g_attach_max'] > 0 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span class='ipsType_medium ipsType_light'>\nCONTENT;\n\n$sprintf = array(\\IPS\\Output\\Plugin\\Filesize::humanReadableFilesize( $member->group['g_attach_max'] * 1024 )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'quota_allowance', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<span class='ipsType_medium ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'quota_allowance_unlimited', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<div class=\"ipsType_medium ipsType_light\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'quota_allowance_disabled', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/div>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction tabTemplate( $leftColumnBlocks, $mainColumnBlocks ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsColumns ipsColumns_collapsePhone'>\n\t<div class='ipsColumn ipsColumn_veryWide'>\n\t\t<div class='ipsPad'>\n\t\t\t\nCONTENT;\n\nforeach ( $leftColumnBlocks as $block ):\n$return .= <<<CONTENT\n\n\t\t\t\t{$block->output()}\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\t<div class='ipsColumn ipsColumn_fluid'>\n\t\t<div class='ipsPad'>\n\t\t\t\nCONTENT;\n\nforeach ( $mainColumnBlocks as $block ):\n$return .= <<<CONTENT\n\n\t\t\t\t{$block->output()}\n\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction tabbedBlock( $member, $block, $title, $tabNames, $activeId, $defaultContent, $editLink ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='ipsBox ipsSpacer_bottom ipsSpacer_double'>\n\t\nCONTENT;\n\nif ( $title !== NULL ):\n$return .= <<<CONTENT\n\n\t\t<h2 class='ipsBox_titleBar ipsType_reset'>\n\t\t\t\nCONTENT;\n\nif ( $editLink and \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( !$member->isAdmin() or \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $editLink, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsPos_right ipsType_medium\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$val = \"{$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$val = \"{$title}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/h2>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( count( $tabNames ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsTabs ipsTabs_contained ipsTabs_small ipsClearfix' id='elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $block ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-ipsTabBar data-ipsTabBar-contentArea='#ipsTabs_content_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $block ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\ndata-ipsTabBar-updateURL='false'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t<a href='#elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $block ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-action='expandTabs'><i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t<ul role='tablist'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $tabNames as $i => $name ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $member->acpUrl()->setQueryString( array( 'do' => 'view', 'blockKey' => $block, 'block[' . $block . ']' => $i ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' id='\nCONTENT;\n\n$return .= htmlspecialchars( md5( $block ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class=\"ipsTabs_item \nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\nipsTabs_activeItem\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( is_array( $name ) ):\n$return .= <<<CONTENT\ntitle='\nCONTENT;\n\n$val = \"{$name[1]}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' data-ipsTooltip\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\ntitle='\nCONTENT;\n\n$val = \"{$name}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n role=\"tab\" aria-selected=\"\nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\ntrue\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nfalse\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( is_array( $name ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<i class=\"fa fa-\nCONTENT;\n$return .= htmlspecialchars( $name[0], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"><\/i>\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$val = \"{$name}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t\t<section id='ipsTabs_content_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $block ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nforeach ( $tabNames as $i => $name ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $i == $activeId ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div id='ipsTabs_elTabs_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $block ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_\nCONTENT;\n\n$return .= htmlspecialchars( md5( $block), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_panel' class=\"ipsTabs_panel\" aria-labelledby=\"\nCONTENT;\n\n$return .= htmlspecialchars( md5( $block ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_tab_\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" aria-hidden=\"false\">\n\t\t\t\t\t{$defaultContent}\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( count( $tabNames ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t<\/section>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction warningView( $warning ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class=\"ipsPad\" id=\"warnhovercard_\nCONTENT;\n$return .= htmlspecialchars( $warning->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\t\n\t<h2 class=\"ipsType_pageTitle\">\n\t\t\nCONTENT;\n\nif ( $warning->canViewDetails() ):\n$return .= <<<CONTENT\n\n\t\t\t<span class='ipsPoints'>\nCONTENT;\n$return .= htmlspecialchars( $warning->points, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\nCONTENT;\n\n$val = \"core_warn_reason_{$warning->reason}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warning', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/h2>\n\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->warnings_acknowledge OR \\IPS\\Member::loggedIn()->members_bitoptions['unacknowledged_warnings'] ):\n$return .= <<<CONTENT\n\n\t\t<p class='ipsType_medium'>\n\t\t\t\nCONTENT;\n\nif ( $warning->acknowledged ):\n$return .= <<<CONTENT\n\n\t\t\t\t<strong class='ipsType_success'><i class='fa fa-check-circle'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warning_acknowledged', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $warning->canAcknowledge() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class='ipsAreaBackground_light ipsPad ipsType_center'>\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $warning->url('acknowledge')->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_important ipsButton_medium ipsButton_fullWidth\"><i class='fa fa-check'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'acknowledge', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t<p class='ipsType_light ipsType_small'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'acknowledge_message', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<strong class='ipsType_light'><i class='fa fa-circle-o'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warning_not_acknowledged', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/p>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $content = $warning->content() and $content->canView() ):\n$return .= <<<CONTENT\n\n\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $content->url()->setQueryString( '_warn', $warning->id ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsType_light ipsType_blendLinks' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warning_go_to_content', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'><i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $content::$icon, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i> &nbsp;&nbsp;\nCONTENT;\n\nif ( $content instanceof \\IPS\\Content\\Comment ):\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $content->item()->mapped('title'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n$return .= htmlspecialchars( $content->mapped('title'), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n<\/a>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $warning->canViewDetails() ):\n$return .= <<<CONTENT\n\n\t\t<hr class='ipsHr'>\n\t\t<div class='ipsPhotoPanel ipsPhotoPanel_tiny'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::load( $warning->moderator ), 'tiny' );\n$return .= <<<CONTENT\n\n\t\t\t<div>\n\t\t\t\t\nCONTENT;\n\nif ( $warning->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controllers=members&do=warningRevoke&id={$warning->id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-confirm data-confirmMessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warning_revoke_blurb', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-confirmType=\"verify\" data-confirmButtons='\nCONTENT;\n\n$return .= json_encode( array( 'yes' => \\IPS\\Member::loggedIn()->language()->addToStack('warning_revoke_undo'), 'no' => \\IPS\\Member::loggedIn()->language()->addToStack('delete'), 'cancel' => \\IPS\\Member::loggedIn()->language()->addToStack('cancel') ) );\n$return .= <<<CONTENT\n' title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'revoke_this_warning', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class='ipsPos_right ipsButton ipsButton_verySmall ipsButton_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'revoke', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<p class=\"ipsType_reset\">\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::load( $warning->moderator )->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warning_byline', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t<p class='ipsType_reset ipsType_light'>\nCONTENT;\n\n$val = ( $warning->date instanceof \\IPS\\DateTime ) ? $warning->date : \\IPS\\DateTime::ts( $warning->date );$return .= $val->html();\n$return .= <<<CONTENT\n<\/p>\n\t\t\t<\/div>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $warning->canViewDetails() or $warning->mq or $warning->rpa or $warning->suspend ):\n$return .= <<<CONTENT\n\n\t\t<hr class='ipsHr'>\n\t\t<h3 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_punishment', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t<br>\n\t\t<ul class='ipsList_bullets ipsType_medium'>\n\t\t\t\nCONTENT;\n\nif ( $warning->canViewDetails() ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\n\t\t\t\t\t\nCONTENT;\n\nif ( $warning->expire_date ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $warning->expire_date < time() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $warning->expire_date == -1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$sprintf = array($warning->points); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_action_points_never_expire', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$sprintf = array($warning->points, \\IPS\\DateTime::ts( $warning->expire_date )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_action_points_expired', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\n$sprintf = array($warning->points, \\IPS\\DateTime::ts( $warning->expire_date )); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_action_points_expire', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$sprintf = array($warning->points); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_action_points', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\t\t\t\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $warning->mq ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'moderation_modq', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n - \n\t\t\t\t\t\nCONTENT;\n\nif ( $warning->mq == -1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'indefinitely', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\DateTime::formatInterval( new \\DateInterval( $warning->mq ), 2 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $warning->rpa ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'moderation_nopost', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n - \n\t\t\t\t\t\nCONTENT;\n\nif ( $warning->rpa == -1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'indefinitely', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\DateTime::formatInterval( new \\DateInterval( $warning->rpa ), 2 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $warning->suspend ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'moderation_banned', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n - \n\t\t\t\t\t\nCONTENT;\n\nif ( $warning->suspend == -1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'indefinitely', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\DateTime::formatInterval( new \\DateInterval( $warning->suspend ), 2 ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $warning->note_member ):\n$return .= <<<CONTENT\n\n\t\t<hr class='ipsHr'>\n\t\t<h3 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_member_note', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t<div class='ipsType_richText ipsType_medium'>\n\t\t\t{$warning->note_member}\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nif ( $warning->note_mods and \\IPS\\Member::loggedIn()->modPermission('mod_see_warn') ):\n$return .= <<<CONTENT\n\n\t\t<hr class='ipsHr'>\n\t\t<h3 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warn_mod_note', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h3>\n\t\t<div class='ipsType_richText ipsType_medium'>\n\t\t\t{$warning->note_mods}\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction warnings( $member, $restrictions, $flagMessage ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class='acpMemberView_contentStats ipsBox ipsSpacer_bottom ipsSpacer_double'>\n\t<h2 class='ipsBox_titleBar ipsType_reset'>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( !$member->isAdmin() or \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=editBlock&block=IPS\\\\core\\\\extensions\\\\core\\\\MemberACPProfileBlocks\\\\Warnings&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsPos_right ipsType_medium\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warnings_and_restrictions', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'edit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warnings_and_restrictions', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t<\/h2>\n\t<div class='ipsPad'>\n\t\t<div class=\"ipsClearfix\">\n\t\t\t\nCONTENT;\n\nif ( $member->member_id != \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t<ul class=\"ipsList_inline ipsPos_right\">\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit' ) and ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_edit_admin' ) or !$member->isAdmin() ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $member->members_bitoptions['bw_is_spammer'] ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=spam&id={$member->member_id}&status=0\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-confirm data-confirmSubmessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'spam_unflag_confirm', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_light ipsButton_small\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'spam_unflag', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=spam&id={$member->member_id}&status=1\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-confirm \nCONTENT;\n\nif ( $flagMessage ):\n$return .= <<<CONTENT\ndata-confirmMessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'spam_flag', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-confirmSubmessage=\"\nCONTENT;\n$return .= htmlspecialchars( $flagMessage, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n class=\"ipsButton ipsButton_light ipsButton_small\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'spam_flag', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_ban' ) and ( \\IPS\\Member::loggedIn()->hasAcpRestriction( 'core', 'members', 'member_ban_admin' ) or !$member->isAdmin() ) and $member->member_id != \\IPS\\Member::loggedIn()->member_id ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controller=members&do=ban&id={$member->member_id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-ipsDialog data-ipsDialog-title=\"\nCONTENT;\n\nif ( $member->temp_ban ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'adjust_ban', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ban', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_light ipsButton_small\">\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $member->temp_ban ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'adjust_ban', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'ban', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->warn_on and !$member->inGroup( explode( ',', \\IPS\\Settings::i()->warn_protected ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<p class=\"ipsType_reset ipsType_large\">\nCONTENT;\n\n$pluralize = array( $member->warn_level ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'member_warn_level', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( !count( $restrictions ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<p class=\"ipsType_reset ipsType_normal\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'no_restrictions_applied', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<ul class=\"ipsList_inline ipsType_negative\">\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $restrictions as $restriction ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$val = \"{$restriction}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/ul>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->modPermission('mod_see_warn') and $warnings = $member->warnings( NULL ) and count( $warnings ) ):\n$return .= <<<CONTENT\n\n\t\t\t<hr class=\"ipsHr\">\n\t\t\t<ol class='ipsDataList'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $warnings as $warning ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsDataItem\">\n\t\t\t\t\t\t<div class='ipsDataItem_icon ipsType_center'>\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controllers=members&do=viewWarning&id={$warning->id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_blendLinks\" data-ipsDialog data-ipsDialog-size='narrow'>\n\t\t\t\t\t\t\t\t<span class=\"ipsPoints\">\nCONTENT;\n$return .= htmlspecialchars( $warning->points, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t<div class='ipsDataItem_main'>\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $warning->canDelete() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controllers=members&do=warningRevoke&id={$warning->id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" data-confirm data-confirmMessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warning_revoke_blurb', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\" data-confirmType=\"verify\" data-confirmButtons='\nCONTENT;\n\n$return .= json_encode( array( 'yes' => \\IPS\\Member::loggedIn()->language()->addToStack('warning_revoke_undo'), 'no' => \\IPS\\Member::loggedIn()->language()->addToStack('delete'), 'cancel' => \\IPS\\Member::loggedIn()->language()->addToStack('cancel') ) );\n$return .= <<<CONTENT\n' class='ipsPos_right ipsButton ipsButton_small ipsButton_light ipsButton_narrow'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'revoke', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/i><\/a>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=members&controllers=members&do=viewWarning&id={$warning->id}\", null, \"\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsType_blendLinks\" data-ipsDialog data-ipsDialog-size='narrow'>\n\t\t\t\t\t\t\t\t<h4 class=\"ipsType_reset\">\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$val = \"core_warn_reason_{$warning->reason}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->warnings_acknowledge ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $warning->acknowledged ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<strong class='ipsType_success'><i class='fa fa-check-circle'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warning_acknowledged', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t<strong class='ipsType_light'><i class='fa fa-circle-o'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'warning_not_acknowledged', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<\/h4>\n\t\t\t\t\t\t\t\t<p class='ipsDataItem_meta ipsType_light'>\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::load( $warning->moderator )->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'byline', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\nCONTENT;\n\n$val = ( $warning->date instanceof \\IPS\\DateTime ) ? $warning->date : \\IPS\\DateTime::ts( $warning->date );$return .= $val->html();\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<\/p>\n\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/ol>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\n\nCONTENT;\n\n\t\treturn $return;\n}}"
VALUE;
